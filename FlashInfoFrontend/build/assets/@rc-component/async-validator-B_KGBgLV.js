import{d as R,e as D,f as C,h as te,i as ie,a as k,b as N,j as W,_ as ee,l as ae}from"../@babel/runtime-bjg2LrFx.js";function Z(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var z=Z(),fe=/%[sdj%]/g,se=function(){};function B(a){if(!a||!a.length)return null;var e={};return a.forEach(function(r){var n=r.field;e[n]=e[n]||[],e[n].push(r)}),e}function b(a){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var t=0,f=r.length;if(typeof a=="function")return a.apply(null,r);if(typeof a=="string"){var i=a.replace(fe,function(s){if(s==="%%")return"%";if(t>=f)return s;switch(s){case"%s":return String(r[t++]);case"%d":return Number(r[t++]);case"%j":try{return JSON.stringify(r[t++])}catch{return"[Circular]"}break;default:return s}});return i}return a}function ce(a){return a==="string"||a==="url"||a==="hex"||a==="email"||a==="date"||a==="pattern"}function p(a,e){return!!(a==null||e==="array"&&Array.isArray(a)&&!a.length||ce(e)&&typeof a=="string"&&!a)}function de(a,e,r){var n=[],t=0,f=a.length;function i(s){n.push.apply(n,C(s||[])),t++,t===f&&r(n)}a.forEach(function(s){e(s,i)})}function Y(a,e,r){var n=0,t=a.length;function f(i){if(i&&i.length){r(i);return}var s=n;n=n+1,s<t?e(a[s],f):r([])}f([])}function oe(a){var e=[];return Object.keys(a).forEach(function(r){e.push.apply(e,C(a[r]||[]))}),e}var G=function(a){te(r,a);var e=ie(r);function r(n,t){var f;return k(this,r),f=e.call(this,"Async Validation Error"),N(W(f),"errors",void 0),N(W(f),"fields",void 0),f.errors=n,f.fields=t,f}return ee(r)}(ae(Error));function ue(a,e,r,n,t){if(e.first){var f=new Promise(function(w,A){var d=function(F){return n(F),F.length?A(new G(F,B(F))):w(t)},h=oe(a);Y(h,r,d)});return f.catch(function(w){return w}),f}var i=e.firstFields===!0?Object.keys(a):e.firstFields||[],s=Object.keys(a),y=s.length,V=0,g=[],m=new Promise(function(w,A){var d=function(c){if(g.push.apply(g,c),V++,V===y)return n(g),g.length?A(new G(g,B(g))):w(t)};s.length||(n(g),w(t)),s.forEach(function(h){var c=a[h];i.indexOf(h)!==-1?Y(c,r,d):de(c,r,d)})});return m.catch(function(w){return w}),m}function ge(a){return!!(a&&a.message!==void 0)}function ye(a,e){for(var r=a,n=0;n<e.length;n++){if(r==null)return r;r=r[e[n]]}return r}function H(a,e){return function(r){var n;return a.fullFields?n=ye(e,a.fullFields):n=e[r.field||a.fullField],ge(r)?(r.field=r.field||a.fullField,r.fieldValue=n,r):{message:typeof r=="function"?r():r,fieldValue:n,field:r.field||a.fullField}}}function Q(a,e){if(e){for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];R(n)==="object"&&R(a[r])==="object"?a[r]=D(D({},a[r]),n):a[r]=n}}return a}var S="enum",he=function(e,r,n,t,f){e[S]=Array.isArray(e[S])?e[S]:[],e[S].indexOf(r)===-1&&t.push(b(f.messages[S],e.fullField,e[S].join(", ")))},pe=function(e,r,n,t,f){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(r)||t.push(b(f.messages.pattern.mismatch,e.fullField,r,e.pattern));else if(typeof e.pattern=="string"){var i=new RegExp(e.pattern);i.test(r)||t.push(b(f.messages.pattern.mismatch,e.fullField,r,e.pattern))}}},me=function(e,r,n,t,f){var i=typeof e.len=="number",s=typeof e.min=="number",y=typeof e.max=="number",V=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=r,m=null,w=typeof r=="number",A=typeof r=="string",d=Array.isArray(r);if(w?m="number":A?m="string":d&&(m="array"),!m)return!1;d&&(g=r.length),A&&(g=r.replace(V,"_").length),i?g!==e.len&&t.push(b(f.messages[m].len,e.fullField,e.len)):s&&!y&&g<e.min?t.push(b(f.messages[m].min,e.fullField,e.min)):y&&!s&&g>e.max?t.push(b(f.messages[m].max,e.fullField,e.max)):s&&y&&(g<e.min||g>e.max)&&t.push(b(f.messages[m].range,e.fullField,e.min,e.max))},re=function(e,r,n,t,f,i){e.required&&(!n.hasOwnProperty(e.field)||p(r,i||e.type))&&t.push(b(f.messages.required,e.fullField))},L;const ve=function(){if(L)return L;var a="[a-fA-F\\d:]",e=function(E){return E&&E.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(a,")|(?<=").concat(a,")(?=\\s|$))"):""},r="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",n="[a-fA-F\\d]{1,4}",t=["(?:".concat(n,":){7}(?:").concat(n,"|:)"),"(?:".concat(n,":){6}(?:").concat(r,"|:").concat(n,"|:)"),"(?:".concat(n,":){5}(?::").concat(r,"|(?::").concat(n,"){1,2}|:)"),"(?:".concat(n,":){4}(?:(?::").concat(n,"){0,1}:").concat(r,"|(?::").concat(n,"){1,3}|:)"),"(?:".concat(n,":){3}(?:(?::").concat(n,"){0,2}:").concat(r,"|(?::").concat(n,"){1,4}|:)"),"(?:".concat(n,":){2}(?:(?::").concat(n,"){0,3}:").concat(r,"|(?::").concat(n,"){1,5}|:)"),"(?:".concat(n,":){1}(?:(?::").concat(n,"){0,4}:").concat(r,"|(?::").concat(n,"){1,6}|:)"),"(?::(?:(?::".concat(n,"){0,5}:").concat(r,"|(?::").concat(n,"){1,7}|:))")],f="(?:%[0-9a-zA-Z]{1,})?",i="(?:".concat(t.join("|"),")").concat(f),s=new RegExp("(?:^".concat(r,"$)|(?:^").concat(i,"$)")),y=new RegExp("^".concat(r,"$")),V=new RegExp("^".concat(i,"$")),g=function(E){return E&&E.exact?s:new RegExp("(?:".concat(e(E)).concat(r).concat(e(E),")|(?:").concat(e(E)).concat(i).concat(e(E),")"),"g")};g.v4=function(q){return q&&q.exact?y:new RegExp("".concat(e(q)).concat(r).concat(e(q)),"g")},g.v6=function(q){return q&&q.exact?V:new RegExp("".concat(e(q)).concat(i).concat(e(q)),"g")};var m="(?:(?:[a-z]+:)?//)",w="(?:\\S+(?::\\S*)?@)?",A=g.v4().source,d=g.v6().source,h="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",c="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",F="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",u="(?::\\d{2,5})?",l='(?:[/?#][^\\s"]*)?',v="(?:".concat(m,"|www\\.)").concat(w,"(?:localhost|").concat(A,"|").concat(d,"|").concat(h).concat(c).concat(F,")").concat(u).concat(l);return L=new RegExp("(?:^".concat(v,"$)"),"i"),L};var X={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},M={integer:function(e){return M.number(e)&&parseInt(e,10)===e},float:function(e){return M.number(e)&&!M.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return R(e)==="object"&&!M.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(X.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(ve())},hex:function(e){return typeof e=="string"&&!!e.match(X.hex)}},le=function(e,r,n,t,f){if(e.required&&r===void 0){re(e,r,n,t,f);return}var i=["integer","float","array","regexp","object","method","email","number","date","url","hex"],s=e.type;i.indexOf(s)>-1?M[s](r)||t.push(b(f.messages.types[s],e.fullField,e.type)):s&&R(r)!==e.type&&t.push(b(f.messages.types[s],e.fullField,e.type))},qe=function(e,r,n,t,f){(/^\s+$/.test(r)||r==="")&&t.push(b(f.messages.whitespace,e.fullField))};const o={required:re,whitespace:qe,type:le,range:me,enum:he,pattern:pe};var we=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r)&&!e.required)return n();o.required(e,r,t,i,f)}n(i)},Fe=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(r==null&&!e.required)return n();o.required(e,r,t,i,f,"array"),r!=null&&(o.type(e,r,t,i,f),o.range(e,r,t,i,f))}n(i)},xe=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r)&&!e.required)return n();o.required(e,r,t,i,f),r!==void 0&&o.type(e,r,t,i,f)}n(i)},be=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r,"date")&&!e.required)return n();if(o.required(e,r,t,i,f),!p(r,"date")){var y;r instanceof Date?y=r:y=new Date(r),o.type(e,y,t,i,f),y&&o.range(e,y.getTime(),t,i,f)}}n(i)},Ee="enum",Ae=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r)&&!e.required)return n();o.required(e,r,t,i,f),r!==void 0&&o[Ee](e,r,t,i,f)}n(i)},Oe=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r)&&!e.required)return n();o.required(e,r,t,i,f),r!==void 0&&(o.type(e,r,t,i,f),o.range(e,r,t,i,f))}n(i)},je=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r)&&!e.required)return n();o.required(e,r,t,i,f),r!==void 0&&(o.type(e,r,t,i,f),o.range(e,r,t,i,f))}n(i)},Pe=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r)&&!e.required)return n();o.required(e,r,t,i,f),r!==void 0&&o.type(e,r,t,i,f)}n(i)},Re=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(r===""&&(r=void 0),p(r)&&!e.required)return n();o.required(e,r,t,i,f),r!==void 0&&(o.type(e,r,t,i,f),o.range(e,r,t,i,f))}n(i)},Ve=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r)&&!e.required)return n();o.required(e,r,t,i,f),r!==void 0&&o.type(e,r,t,i,f)}n(i)},De=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r,"string")&&!e.required)return n();o.required(e,r,t,i,f),p(r,"string")||o.pattern(e,r,t,i,f)}n(i)},Ne=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r)&&!e.required)return n();o.required(e,r,t,i,f),p(r)||o.type(e,r,t,i,f)}n(i)},Te=function(e,r,n,t,f){var i=[],s=Array.isArray(r)?"array":R(r);o.required(e,r,t,i,f,s),n(i)},Se=function(e,r,n,t,f){var i=[],s=e.required||!e.required&&t.hasOwnProperty(e.field);if(s){if(p(r,"string")&&!e.required)return n();o.required(e,r,t,i,f,"string"),p(r,"string")||(o.type(e,r,t,i,f),o.range(e,r,t,i,f),o.pattern(e,r,t,i,f),e.whitespace===!0&&o.whitespace(e,r,t,i,f))}n(i)},J=function(e,r,n,t,f){var i=e.type,s=[],y=e.required||!e.required&&t.hasOwnProperty(e.field);if(y){if(p(r,i)&&!e.required)return n();o.required(e,r,t,s,f,i),p(r,i)||o.type(e,r,t,s,f)}n(s)};const _={string:Se,method:Pe,number:Re,boolean:xe,regexp:Ne,integer:je,float:Oe,array:Fe,object:Ve,enum:Ae,pattern:De,date:be,url:J,hex:J,email:J,required:Te,any:we};var U=function(){function a(e){k(this,a),N(this,"rules",null),N(this,"_messages",z),this.define(e)}return ee(a,[{key:"define",value:function(r){var n=this;if(!r)throw new Error("Cannot configure a schema with no rules");if(R(r)!=="object"||Array.isArray(r))throw new Error("Rules must be an object");this.rules={},Object.keys(r).forEach(function(t){var f=r[t];n.rules[t]=Array.isArray(f)?f:[f]})}},{key:"messages",value:function(r){return r&&(this._messages=Q(Z(),r)),this._messages}},{key:"validate",value:function(r){var n=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},i=r,s=t,y=f;if(typeof s=="function"&&(y=s,s={}),!this.rules||Object.keys(this.rules).length===0)return y&&y(null,i),Promise.resolve(i);function V(d){var h=[],c={};function F(l){if(Array.isArray(l)){var v;h=(v=h).concat.apply(v,C(l))}else h.push(l)}for(var u=0;u<d.length;u++)F(d[u]);h.length?(c=B(h),y(h,c)):y(null,i)}if(s.messages){var g=this.messages();g===z&&(g=Z()),Q(g,s.messages),s.messages=g}else s.messages=this.messages();var m={},w=s.keys||Object.keys(this.rules);w.forEach(function(d){var h=n.rules[d],c=i[d];h.forEach(function(F){var u=F;typeof u.transform=="function"&&(i===r&&(i=D({},i)),c=i[d]=u.transform(c),c!=null&&(u.type=u.type||(Array.isArray(c)?"array":R(c)))),typeof u=="function"?u={validator:u}:u=D({},u),u.validator=n.getValidationMethod(u),u.validator&&(u.field=d,u.fullField=u.fullField||d,u.type=n.getType(u),m[d]=m[d]||[],m[d].push({rule:u,value:c,source:i,field:d}))})});var A={};return ue(m,s,function(d,h){var c=d.rule,F=(c.type==="object"||c.type==="array")&&(R(c.fields)==="object"||R(c.defaultField)==="object");F=F&&(c.required||!c.required&&d.value),c.field=d.field;function u(x,T){return D(D({},T),{},{fullField:"".concat(c.fullField,".").concat(x),fullFields:c.fullFields?[].concat(C(c.fullFields),[x]):[x]})}function l(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],T=Array.isArray(x)?x:[x];!s.suppressWarning&&T.length&&a.warning("async-validator:",T),T.length&&c.message!==void 0&&(T=[].concat(c.message));var j=T.map(H(c,i));if(s.first&&j.length)return A[c.field]=1,h(j);if(!F)h(j);else{if(c.required&&!d.value)return c.message!==void 0?j=[].concat(c.message).map(H(c,i)):s.error&&(j=[s.error(c,b(s.messages.required,c.field))]),h(j);var $={};c.defaultField&&Object.keys(d.value).map(function(P){$[P]=c.defaultField}),$=D(D({},$),d.rule.fields);var I={};Object.keys($).forEach(function(P){var O=$[P],ne=Array.isArray(O)?O:[O];I[P]=ne.map(u.bind(null,P))});var K=new a(I);K.messages(s.messages),d.rule.options&&(d.rule.options.messages=s.messages,d.rule.options.error=s.error),K.validate(d.value,d.rule.options||s,function(P){var O=[];j&&j.length&&O.push.apply(O,C(j)),P&&P.length&&O.push.apply(O,C(P)),h(O.length?O:null)})}}var v;if(c.asyncValidator)v=c.asyncValidator(c,d.value,l,d.source,s);else if(c.validator){try{v=c.validator(c,d.value,l,d.source,s)}catch(x){var q,E;(q=(E=console).error)===null||q===void 0||q.call(E,x),s.suppressValidatorError||setTimeout(function(){throw x},0),l(x.message)}v===!0?l():v===!1?l(typeof c.message=="function"?c.message(c.fullField||c.field):c.message||"".concat(c.fullField||c.field," fails")):v instanceof Array?l(v):v instanceof Error&&l(v.message)}v&&v.then&&v.then(function(){return l()},function(x){return l(x)})},function(d){V(d)},i)}},{key:"getType",value:function(r){if(r.type===void 0&&r.pattern instanceof RegExp&&(r.type="pattern"),typeof r.validator!="function"&&r.type&&!_.hasOwnProperty(r.type))throw new Error(b("Unknown rule type %s",r.type));return r.type||"string"}},{key:"getValidationMethod",value:function(r){if(typeof r.validator=="function")return r.validator;var n=Object.keys(r),t=n.indexOf("message");return t!==-1&&n.splice(t,1),n.length===1&&n[0]==="required"?_.required:_[this.getType(r)]||void 0}}]),a}();N(U,"register",function(e,r){if(typeof r!="function")throw new Error("Cannot register a validator by type, validator is not a function");_[e]=r});N(U,"warning",se);N(U,"messages",z);N(U,"validators",_);export{U as S};
