import{e as $,b as C,g as ct,c as I,d as Xe,_ as Dt,a as zt,k as Tt}from"./@babel/runtime-DcA5D6RU.js";import{c as ze}from"./classnames-C9FZUsQl.js";import{R as ft}from"./rc-resize-observer-DDTICJuD.js";import{v as U,u as Re,d as rt}from"./rc-util-JLx9b6Sx.js";import{r as t}from"./react-DHBI0EtI.js";import{r as nt}from"./react-dom-CAvYKTQr.js";var vt=t.forwardRef(function(e,c){var d=e.height,a=e.offsetY,h=e.offsetX,g=e.children,s=e.prefixCls,u=e.onInnerResize,b=e.innerProps,f=e.rtl,R=e.extra,i={},S={display:"flex",flexDirection:"column"};return a!==void 0&&(i={height:d,position:"relative",overflow:"hidden"},S=$($({},S),{},C(C(C(C(C({transform:"translateY(".concat(a,"px)")},f?"marginRight":"marginLeft",-h),"position","absolute"),"left",0),"right",0),"top",0))),t.createElement("div",{style:i},t.createElement(ft,{onResize:function(m){var l=m.offsetHeight;l&&u&&u()}},t.createElement("div",ct({style:S,className:ze(C({},"".concat(s,"-holder-inner"),s)),ref:c},b),g,R)))});vt.displayName="Filler";function Ct(e){var c=e.children,d=e.setRef,a=t.useCallback(function(h){d(h)},[]);return t.cloneElement(c,{ref:a})}function It(e,c,d,a,h,g,s,u){var b=u.getKey;return e.slice(c,d+1).map(function(f,R){var i=c+R,S=s(f,i,{style:{width:a},offsetX:h}),o=b(f);return t.createElement(Ct,{key:o,setRef:function(l){return g(f,l)}},S)})}function Ht(e,c,d){var a=e.length,h=c.length,g,s;if(a===0&&h===0)return null;a<h?(g=e,s=c):(g=c,s=e);var u={__EMPTY_ITEM__:!0};function b(m){return m!==void 0?d(m):u}for(var f=null,R=Math.abs(a-h)!==1,i=0;i<s.length;i+=1){var S=b(g[i]),o=b(s[i]);if(S!==o){f=i,R=R||S!==b(s[i+1]);break}}return f===null?null:{index:f,multiple:R}}function Pt(e,c,d){var a=t.useState(e),h=I(a,2),g=h[0],s=h[1],u=t.useState(null),b=I(u,2),f=b[0],R=b[1];return t.useEffect(function(){var i=Ht(g||[],e||[],c);(i==null?void 0:i.index)!==void 0&&R(e[i.index]),s(e)},[e]),[f]}var at=(typeof navigator>"u"?"undefined":Xe(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const dt=function(e,c,d,a){var h=t.useRef(!1),g=t.useRef(null);function s(){clearTimeout(g.current),h.current=!0,g.current=setTimeout(function(){h.current=!1},50)}var u=t.useRef({top:e,bottom:c,left:d,right:a});return u.current.top=e,u.current.bottom=c,u.current.left=d,u.current.right=a,function(b,f){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=b?f<0&&u.current.left||f>0&&u.current.right:f<0&&u.current.top||f>0&&u.current.bottom;return R&&i?(clearTimeout(g.current),h.current=!1):(!i||h.current)&&s(),!h.current&&i}};function Ot(e,c,d,a,h,g,s){var u=t.useRef(0),b=t.useRef(null),f=t.useRef(null),R=t.useRef(!1),i=dt(c,d,a,h);function S(v,w){if(U.cancel(b.current),!i(!1,w)){var y=v;if(!y._virtualHandled)y._virtualHandled=!0;else return;u.current+=w,f.current=w,at||y.preventDefault(),b.current=U(function(){var P=R.current?10:1;s(u.current*P,!1),u.current=0})}}function o(v,w){s(w,!0),at||v.preventDefault()}var m=t.useRef(null),l=t.useRef(null);function E(v){if(e){U.cancel(l.current),l.current=U(function(){m.current=null},2);var w=v.deltaX,y=v.deltaY,P=v.shiftKey,O=w,x=y;(m.current==="sx"||!m.current&&P&&y&&!w)&&(O=y,x=0,m.current="sx");var k=Math.abs(O),Y=Math.abs(x);m.current===null&&(m.current=g&&k>Y?"x":"y"),m.current==="y"?S(v,x):o(v,O)}}function M(v){e&&(R.current=v.detail===f.current)}return[E,M]}function kt(e,c,d,a){var h=t.useMemo(function(){return[new Map,[]]},[e,d.id,a]),g=I(h,2),s=g[0],u=g[1],b=function(R){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,S=s.get(R),o=s.get(i);if(S===void 0||o===void 0)for(var m=e.length,l=u.length;l<m;l+=1){var E,M=e[l],v=c(M);s.set(v,l);var w=(E=d.get(v))!==null&&E!==void 0?E:a;if(u[l]=(u[l-1]||0)+w,v===R&&(S=l),v===i&&(o=l),S!==void 0&&o!==void 0)break}return{top:u[S-1]||0,bottom:u[o]}};return b}var Nt=function(){function e(){zt(this,e),C(this,"maps",void 0),C(this,"id",0),C(this,"diffRecords",new Map),this.maps=Object.create(null)}return Dt(e,[{key:"set",value:function(d,a){this.diffRecords.set(d,this.maps[d]),this.maps[d]=a,this.id+=1}},{key:"get",value:function(d){return this.maps[d]}},{key:"resetRecord",value:function(){this.diffRecords.clear()}},{key:"getRecord",value:function(){return this.diffRecords}}]),e}();function it(e){var c=parseFloat(e);return isNaN(c)?0:c}function $t(e,c,d){var a=t.useState(0),h=I(a,2),g=h[0],s=h[1],u=t.useRef(new Map),b=t.useRef(new Nt),f=t.useRef(0);function R(){f.current+=1}function i(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;R();var m=function(){var M=!1;u.current.forEach(function(v,w){if(v&&v.offsetParent){var y=v.offsetHeight,P=getComputedStyle(v),O=P.marginTop,x=P.marginBottom,k=it(O),Y=it(x),A=y+k+Y;b.current.get(w)!==A&&(b.current.set(w,A),M=!0)}}),M&&s(function(v){return v+1})};if(o)m();else{f.current+=1;var l=f.current;Promise.resolve().then(function(){l===f.current&&m()})}}function S(o,m){var l=e(o);u.current.get(l),m?(u.current.set(l,m),i()):u.current.delete(l)}return t.useEffect(function(){return R},[]),[S,i,b.current,g]}var ot=14/15;function Bt(e,c,d){var a=t.useRef(!1),h=t.useRef(0),g=t.useRef(0),s=t.useRef(null),u=t.useRef(null),b,f=function(o){if(a.current){var m=Math.ceil(o.touches[0].pageX),l=Math.ceil(o.touches[0].pageY),E=h.current-m,M=g.current-l,v=Math.abs(E)>Math.abs(M);v?h.current=m:g.current=l;var w=d(v,v?E:M,!1,o);w&&o.preventDefault(),clearInterval(u.current),w&&(u.current=setInterval(function(){v?E*=ot:M*=ot;var y=Math.floor(v?E:M);(!d(v,y,!0)||Math.abs(y)<=.1)&&clearInterval(u.current)},16))}},R=function(){a.current=!1,b()},i=function(o){b(),o.touches.length===1&&!a.current&&(a.current=!0,h.current=Math.ceil(o.touches[0].pageX),g.current=Math.ceil(o.touches[0].pageY),s.current=o.target,s.current.addEventListener("touchmove",f,{passive:!1}),s.current.addEventListener("touchend",R,{passive:!0}))};b=function(){s.current&&(s.current.removeEventListener("touchmove",f),s.current.removeEventListener("touchend",R))},Re(function(){return e&&c.current.addEventListener("touchstart",i,{passive:!0}),function(){var S;(S=c.current)===null||S===void 0||S.removeEventListener("touchstart",i),b(),clearInterval(u.current)}},[e])}function ut(e){return Math.floor(Math.pow(e,.5))}function Ye(e,c){var d="touches"in e?e.touches[0]:e;return d[c?"pageX":"pageY"]-window[c?"scrollX":"scrollY"]}function Ft(e,c,d){t.useEffect(function(){var a=c.current;if(e&&a){var h=!1,g,s,u=function(){U.cancel(g)},b=function S(){u(),g=U(function(){d(s),S()})},f=function(){h=!1,u()},R=function(o){if(!(o.target.draggable||o.button!==0)){var m=o;m._virtualHandled||(m._virtualHandled=!0,h=!0)}},i=function(o){if(h){var m=Ye(o,!1),l=a.getBoundingClientRect(),E=l.top,M=l.bottom;if(m<=E){var v=E-m;s=-ut(v),b()}else if(m>=M){var w=m-M;s=ut(w),b()}else u()}};return a.addEventListener("mousedown",R),a.ownerDocument.addEventListener("mouseup",f),a.ownerDocument.addEventListener("mousemove",i),a.ownerDocument.addEventListener("dragend",f),function(){a.removeEventListener("mousedown",R),a.ownerDocument.removeEventListener("mouseup",f),a.ownerDocument.removeEventListener("mousemove",i),a.ownerDocument.removeEventListener("dragend",f),u()}}},[e])}var Yt=10;function Xt(e,c,d,a,h,g,s,u){var b=t.useRef(),f=t.useState(null),R=I(f,2),i=R[0],S=R[1];return Re(function(){if(i&&i.times<Yt){if(!e.current){S(function(re){return $({},re)});return}g();var o=i.targetAlign,m=i.originAlign,l=i.index,E=i.offset,M=e.current.clientHeight,v=!1,w=o,y=null;if(M){for(var P=o||m,O=0,x=0,k=0,Y=Math.min(c.length-1,l),A=0;A<=Y;A+=1){var B=h(c[A]);x=O;var J=d.get(B);k=x+(J===void 0?a:J),O=k}for(var V=P==="top"?E:M-E,Q=Y;Q>=0;Q-=1){var ee=h(c[Q]),H=d.get(ee);if(H===void 0){v=!0;break}if(V-=H,V<=0)break}switch(P){case"top":y=x-E;break;case"bottom":y=k-M+E;break;default:{var te=e.current.scrollTop,N=te+M;x<te?w="top":k>N&&(w="bottom")}}y!==null&&s(y),y!==i.lastTop&&(v=!0)}v&&S($($({},i),{},{times:i.times+1,targetAlign:w,lastTop:y}))}},[i,e.current]),function(o){if(o==null){u();return}if(U.cancel(b.current),typeof o=="number")s(o);else if(o&&Xe(o)==="object"){var m,l=o.align;"index"in o?m=o.index:m=c.findIndex(function(v){return h(v)===o.key});var E=o.offset,M=E===void 0?0:E;S({times:0,index:m,offset:M,originAlign:l})}}}var lt=t.forwardRef(function(e,c){var d=e.prefixCls,a=e.rtl,h=e.scrollOffset,g=e.scrollRange,s=e.onStartMove,u=e.onStopMove,b=e.onScroll,f=e.horizontal,R=e.spinSize,i=e.containerSize,S=e.style,o=e.thumbStyle,m=e.showScrollBar,l=t.useState(!1),E=I(l,2),M=E[0],v=E[1],w=t.useState(null),y=I(w,2),P=y[0],O=y[1],x=t.useState(null),k=I(x,2),Y=k[0],A=k[1],B=!a,J=t.useRef(),V=t.useRef(),Q=t.useState(m),ee=I(Q,2),H=ee[0],te=ee[1],N=t.useRef(),re=function(){m===!0||m===!1||(clearTimeout(N.current),te(!0),N.current=setTimeout(function(){te(!1)},3e3))},j=g-i||0,X=i-R||0,ue=t.useMemo(function(){if(h===0||j===0)return 0;var F=h/j;return F*X},[h,j,X]),_=function(D){D.stopPropagation(),D.preventDefault()},K=t.useRef({top:ue,dragging:M,pageY:P,startTop:Y});K.current={top:ue,dragging:M,pageY:P,startTop:Y};var le=function(D){v(!0),O(Ye(D,f)),A(K.current.top),s(),D.stopPropagation(),D.preventDefault()};t.useEffect(function(){var F=function(he){he.preventDefault()},D=J.current,z=V.current;return D.addEventListener("touchstart",F,{passive:!1}),z.addEventListener("touchstart",le,{passive:!1}),function(){D.removeEventListener("touchstart",F),z.removeEventListener("touchstart",le)}},[]);var ve=t.useRef();ve.current=j;var pe=t.useRef();pe.current=X,t.useEffect(function(){if(M){var F,D=function(he){var se=K.current,Te=se.dragging,be=se.pageY,Me=se.startTop;U.cancel(F);var me=J.current.getBoundingClientRect(),Ce=i/(f?me.width:me.height);if(Te){var Z=(Ye(he,f)-be)*Ce,ce=Me;!B&&f?ce-=Z:ce+=Z;var Ee=ve.current,we=pe.current,Ie=we?ce/we:0,ae=Math.ceil(Ie*Ee);ae=Math.max(ae,0),ae=Math.min(ae,Ee),F=U(function(){b(ae,f)})}},z=function(){v(!1),u()};return window.addEventListener("mousemove",D,{passive:!0}),window.addEventListener("touchmove",D,{passive:!0}),window.addEventListener("mouseup",z,{passive:!0}),window.addEventListener("touchend",z,{passive:!0}),function(){window.removeEventListener("mousemove",D),window.removeEventListener("touchmove",D),window.removeEventListener("mouseup",z),window.removeEventListener("touchend",z),U.cancel(F)}}},[M]),t.useEffect(function(){return re(),function(){clearTimeout(N.current)}},[h]),t.useImperativeHandle(c,function(){return{delayHidden:re}});var G="".concat(d,"-scrollbar"),W={position:"absolute",visibility:H?null:"hidden"},de={position:"absolute",borderRadius:99,background:"var(--rc-virtual-list-scrollbar-bg, rgba(0, 0, 0, 0.5))",cursor:"pointer",userSelect:"none"};return f?(Object.assign(W,{height:8,left:0,right:0,bottom:0}),Object.assign(de,C({height:"100%",width:R},B?"left":"right",ue))):(Object.assign(W,C({width:8,top:0,bottom:0},B?"right":"left",0)),Object.assign(de,{width:"100%",height:R,top:ue})),t.createElement("div",{ref:J,className:ze(G,C(C(C({},"".concat(G,"-horizontal"),f),"".concat(G,"-vertical"),!f),"".concat(G,"-visible"),H)),style:$($({},W),S),onMouseDown:_,onMouseMove:re},t.createElement("div",{ref:V,className:ze("".concat(G,"-thumb"),C({},"".concat(G,"-thumb-moving"),M)),style:$($({},de),o),onMouseDown:le}))}),Wt=20;function st(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=e/c*e;return isNaN(d)&&(d=0),d=Math.max(d,Wt),Math.floor(d)}var jt=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles","showScrollBar"],At=[],Vt={overflowY:"auto",overflowAnchor:"none"};function Kt(e,c){var d=e.prefixCls,a=d===void 0?"rc-virtual-list":d,h=e.className,g=e.height,s=e.itemHeight,u=e.fullHeight,b=u===void 0?!0:u,f=e.style,R=e.data,i=e.children,S=e.itemKey,o=e.virtual,m=e.direction,l=e.scrollWidth,E=e.component,M=E===void 0?"div":E,v=e.onScroll,w=e.onVirtualScroll,y=e.onVisibleChange,P=e.innerProps,O=e.extraRender,x=e.styles,k=e.showScrollBar,Y=k===void 0?"optional":k,A=Tt(e,jt),B=t.useCallback(function(n){return typeof S=="function"?S(n):n==null?void 0:n[S]},[S]),J=$t(B),V=I(J,4),Q=V[0],ee=V[1],H=V[2],te=V[3],N=!!(o!==!1&&g&&s),re=t.useMemo(function(){return Object.values(H.maps).reduce(function(n,r){return n+r},0)},[H.id,H.maps]),j=N&&R&&(Math.max(s*R.length,re)>g||!!l),X=m==="rtl",ue=ze(a,C({},"".concat(a,"-rtl"),X),h),_=R||At,K=t.useRef(),le=t.useRef(),ve=t.useRef(),pe=t.useState(0),G=I(pe,2),W=G[0],de=G[1],F=t.useState(0),D=I(F,2),z=D[0],ne=D[1],he=t.useState(!1),se=I(he,2),Te=se[0],be=se[1],Me=function(){be(!0)},me=function(){be(!1)},Ce={getKey:B};function Z(n){de(function(r){var p;typeof n=="function"?p=n(r):p=n;var L=pt(p);return K.current.scrollTop=L,L})}var ce=t.useRef({start:0,end:_.length}),Ee=t.useRef(),we=Pt(_,B),Ie=I(we,1),ae=Ie[0];Ee.current=ae;var ye=t.useMemo(function(){if(!N)return{scrollHeight:void 0,start:0,end:_.length-1,offset:void 0};if(!j){var n;return{scrollHeight:((n=le.current)===null||n===void 0?void 0:n.offsetHeight)||0,start:0,end:_.length-1,offset:void 0}}for(var r=0,p,L,T,De=_.length,oe=0;oe<De;oe+=1){var Be=_[oe],_t=B(Be),tt=H.get(_t),Fe=r+(tt===void 0?s:tt);Fe>=W&&p===void 0&&(p=oe,L=r),Fe>W+g&&T===void 0&&(T=oe),r=Fe}return p===void 0&&(p=0,L=0,T=Math.ceil(g/s)),T===void 0&&(T=_.length-1),T=Math.min(T+1,_.length-1),{scrollHeight:r,start:p,end:T,offset:L}},[j,N,W,_,te,g]),ie=ye.scrollHeight,fe=ye.start,ge=ye.end,We=ye.offset;ce.current.start=fe,ce.current.end=ge,t.useLayoutEffect(function(){var n=H.getRecord();if(n.size===1){var r=Array.from(n.keys())[0],p=n.get(r),L=_[fe];if(L&&p===void 0){var T=B(L);if(T===r){var De=H.get(r),oe=De-s;Z(function(Be){return Be+oe})}}}H.resetRecord()},[ie]);var ht=t.useState({width:0,height:g}),je=I(ht,2),q=je[0],mt=je[1],gt=function(r){mt({width:r.offsetWidth,height:r.offsetHeight})},Ae=t.useRef(),Ve=t.useRef(),St=t.useMemo(function(){return st(q.width,l)},[q.width,l]),Rt=t.useMemo(function(){return st(q.height,ie)},[q.height,ie]),He=ie-g,Pe=t.useRef(He);Pe.current=He;function pt(n){var r=n;return Number.isNaN(Pe.current)||(r=Math.min(r,Pe.current)),r=Math.max(r,0),r}var xe=W<=0,Le=W>=He,Ke=z<=0,Ue=z>=l,bt=dt(xe,Le,Ke,Ue),Oe=function(){return{x:X?-z:z,y:W}},ke=t.useRef(Oe()),_e=rt(function(n){if(w){var r=$($({},Oe()),n);(ke.current.x!==r.x||ke.current.y!==r.y)&&(w(r),ke.current=r)}});function Ge(n,r){var p=n;r?(nt.flushSync(function(){ne(p)}),_e()):Z(p)}function Mt(n){var r=n.currentTarget.scrollTop;r!==W&&Z(r),v==null||v(n),_e()}var Ne=function(r){var p=r,L=l?l-q.width:0;return p=Math.max(p,0),p=Math.min(p,L),p},Et=rt(function(n,r){r?(nt.flushSync(function(){ne(function(p){var L=p+(X?-n:n);return Ne(L)})}),_e()):Z(function(p){var L=p+n;return L})}),wt=Ot(N,xe,Le,Ke,Ue,!!l,Et),Ze=I(wt,2),$e=Ze[0],qe=Ze[1];Bt(N,K,function(n,r,p,L){var T=L;return bt(n,r,p)?!1:!T||!T._virtualHandled?(T&&(T._virtualHandled=!0),$e({preventDefault:function(){},deltaX:n?r:0,deltaY:n?0:r}),!0):!1}),Ft(j,K,function(n){Z(function(r){return r+n})}),Re(function(){function n(p){var L=xe&&p.detail<0,T=Le&&p.detail>0;N&&!L&&!T&&p.preventDefault()}var r=K.current;return r.addEventListener("wheel",$e,{passive:!1}),r.addEventListener("DOMMouseScroll",qe,{passive:!0}),r.addEventListener("MozMousePixelScroll",n,{passive:!1}),function(){r.removeEventListener("wheel",$e),r.removeEventListener("DOMMouseScroll",qe),r.removeEventListener("MozMousePixelScroll",n)}},[N,xe,Le]),Re(function(){if(l){var n=Ne(z);ne(n),_e({x:n})}},[q.width,l]);var Je=function(){var r,p;(r=Ae.current)===null||r===void 0||r.delayHidden(),(p=Ve.current)===null||p===void 0||p.delayHidden()},Qe=Xt(K,_,H,s,B,function(){return ee(!0)},Z,Je);t.useImperativeHandle(c,function(){return{nativeElement:ve.current,getScrollInfo:Oe,scrollTo:function(r){function p(L){return L&&Xe(L)==="object"&&("left"in L||"top"in L)}p(r)?(r.left!==void 0&&ne(Ne(r.left)),Qe(r.top)):Qe(r)}}}),Re(function(){if(y){var n=_.slice(fe,ge+1);y(n,_)}},[fe,ge,_]);var yt=kt(_,B,H,s),xt=O==null?void 0:O({start:fe,end:ge,virtual:j,offsetX:z,offsetY:We,rtl:X,getSize:yt}),Lt=It(_,fe,ge,l,z,Q,i,Ce),Se=null;g&&(Se=$(C({},b?"height":"maxHeight",g),Vt),N&&(Se.overflowY="hidden",l&&(Se.overflowX="hidden"),Te&&(Se.pointerEvents="none")));var et={};return X&&(et.dir="rtl"),t.createElement("div",ct({ref:ve,style:$($({},f),{},{position:"relative"}),className:ue},et,A),t.createElement(ft,{onResize:gt},t.createElement(M,{className:"".concat(a,"-holder"),style:Se,ref:K,onScroll:Mt,onMouseEnter:Je},t.createElement(vt,{prefixCls:a,height:ie,offsetX:z,offsetY:We,scrollWidth:l,onInnerResize:ee,ref:le,innerProps:P,rtl:X,extra:xt},Lt))),j&&ie>g&&t.createElement(lt,{ref:Ae,prefixCls:a,scrollOffset:W,scrollRange:ie,rtl:X,onScroll:Ge,onStartMove:Me,onStopMove:me,spinSize:Rt,containerSize:q.height,style:x==null?void 0:x.verticalScrollBar,thumbStyle:x==null?void 0:x.verticalScrollBarThumb,showScrollBar:Y}),j&&l>q.width&&t.createElement(lt,{ref:Ve,prefixCls:a,scrollOffset:z,scrollRange:l,rtl:X,onScroll:Ge,onStartMove:Me,onStopMove:me,spinSize:St,containerSize:q.width,horizontal:!0,style:x==null?void 0:x.horizontalScrollBar,thumbStyle:x==null?void 0:x.horizontalScrollBarThumb,showScrollBar:Y}))}var Ut=t.forwardRef(Kt);Ut.displayName="List";export{Ut as L};
